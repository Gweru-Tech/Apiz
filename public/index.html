<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ntando Mods API - Interactive Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .version-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .endpoint-card {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .endpoint-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .endpoint-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .method-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
        }

        .method-get {
            background: #28a745;
            color: white;
        }

        .method-post {
            background: #007bff;
            color: white;
        }

        .endpoint-description {
            color: #666;
            margin: 10px 0;
            line-height: 1.6;
        }

        .test-form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid #e2e8f0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95em;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background 0.3s;
            width: 100%;
        }

        .test-button:hover {
            background: #764ba2;
        }

        .test-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .result-container {
            margin-top: 20px;
            display: none;
        }

        .result-container.show {
            display: block;
        }

        .api-url-display {
            background: #2d3748;
            color: #68d391;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin-bottom: 15px;
            overflow-x: auto;
            font-size: 0.9em;
            word-break: break-all;
        }

        .api-url-label {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }

        .result-box {
            background: #2d3748;
            color: #68d391;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            font-size: 0.9em;
            max-height: 400px;
            overflow-y: auto;
        }

        .result-success {
            border-left: 4px solid #28a745;
        }

        .result-error {
            border-left: 4px solid #dc3545;
            color: #ff6b6b;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .copy-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .copy-button:hover {
            background: #218838;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #28a745;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }

        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .feature-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .footer {
            background: #2d3748;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .footer a {
            color: #68d391;
            text-decoration: none;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .toast.show {
            display: block;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
            }
            to {
                transform: translateX(0);
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .features {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Ntando Mods API</h1>
            <p>Interactive API Testing & Documentation</p>
            <span class="version-badge">v1.0.0</span>
            <div style="margin-top: 15px;">
                <span class="status-indicator"></span>
                <span>API Status: <span id="api-status">Checking...</span></span>
            </div>
        </div>

        <div class="content">
            <!-- Features Section -->
            <div class="section">
                <h2>‚ú® Features</h2>
                <div class="features">
                    <div class="feature-card">
                        <div class="feature-icon">üéµ</div>
                        <div class="feature-title">YouTube MP3</div>
                        <p>Extract audio from any YouTube video</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üé•</div>
                        <div class="feature-title">YouTube MP4</div>
                        <p>Download videos in multiple qualities</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîç</div>
                        <div class="feature-title">YouTube Search</div>
                        <p>Search and discover videos</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">ü§ñ</div>
                        <div class="feature-title">GPT Chat</div>
                        <p>AI-powered conversations</p>
                    </div>
                </div>
            </div>

            <!-- YouTube Endpoints -->
            <div class="section">
                <h2>üì∫ YouTube Endpoints</h2>

                <!-- MP3 Download -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-get">GET</span>
                        Download MP3
                    </div>
                    <div class="endpoint-description">
                        Extract and download audio from YouTube videos in MP3 format
                    </div>
                    
                                        <div class="test-form">
                        <div class="form-group">
                            <label for="mp3-url">YouTube URL:</label>
                            <input type="text" id="mp3-url" placeholder="https://youtube.com/watch?v=..." value="https://youtube.com/watch?v=dQw4w9WgXcQ">
                        </div>
                        <button class="test-button" onclick="testMP3()">
                            <span class="button-text">Test API</span>
                        </button>
                        <div class="result-container" id="mp3-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="mp3-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('mp3-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="mp3-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('mp3-response')">Copy Response</button>
                        </div>
                    </div>
                </div>

                <!-- MP4 Download -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-get">GET</span>
                        Download MP4
                    </div>
                    <div class="endpoint-description">
                        Download YouTube videos in MP4 format with quality selection
                    </div>
                    
                    <div class="test-form">
                        <div class="form-group">
                            <label for="mp4-url">YouTube URL:</label>
                            <input type="text" id="mp4-url" placeholder="https://youtube.com/watch?v=..." value="https://youtube.com/watch?v=dQw4w9WgXcQ">
                        </div>
                        <div class="form-group">
                            <label for="mp4-quality">Quality:</label>
                            <select id="mp4-quality">
                                <option value="highest">Highest</option>
                                <option value="lowest">Lowest</option>
                            </select>
                        </div>
                        <button class="test-button" onclick="testMP4()">
                            <span class="button-text">Test API</span>
                        </button>
                        <div class="result-container" id="mp4-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="mp4-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('mp4-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="mp4-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('mp4-response')">Copy Response</button>
                        </div>
                    </div>
                </div>

                <!-- YouTube Search -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-get">GET</span>
                        Search YouTube
                    </div>
                    <div class="endpoint-description">
                        Search for YouTube videos by keyword
                    </div>
                    
                    <div class="test-form">
                        <div class="form-group">
                            <label for="search-query">Search Query:</label>
                            <input type="text" id="search-query" placeholder="Enter search term..." value="music">
                        </div>
                        <div class="form-group">
                            <label for="search-limit">Results Limit:</label>
                            <input type="number" id="search-limit" placeholder="10" value="10" min="1" max="50">
                        </div>
                        <button class="test-button" onclick="testSearch()">
                            <span class="button-text">Test API</span>
                        </button>
                        <div class="result-container" id="search-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="search-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('search-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="search-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('search-response')">Copy Response</button>
                        </div>
                    </div>
                </div>

                <!-- Video Info -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-get">GET</span>
                        Get Video Info
                    </div>
                    <div class="endpoint-description">
                        Get detailed information about a YouTube video
                    </div>
                    
                    <div class="test-form">
                        <div class="form-group">
                            <label for="info-url">YouTube URL:</label>
                            <input type="text" id="info-url" placeholder="https://youtube.com/watch?v=..." value="https://youtube.com/watch?v=dQw4w9WgXcQ">
                        </div>
                        <button class="test-button" onclick="testInfo()">
                            <span class="button-text">Test API</span>
                        </button>
                        <div class="result-container" id="info-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="info-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('info-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="info-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('info-response')">Copy Response</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GPT Endpoints -->
            <div class="section">
                <h2>ü§ñ GPT AI Endpoints</h2>

                <!-- Chat with GPT -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-post">POST</span>
                        Chat with GPT
                    </div>
                    <div class="endpoint-description">
                        Send messages to GPT AI and receive intelligent responses
                    </div>
                    
                    <div class="test-form">
                        <div class="form-group">
                            <label for="gpt-message">Message:</label>
                            <textarea id="gpt-message" placeholder="Enter your message...">Hello, how are you?</textarea>
                        </div>
                        <div class="form-group">
                            <label for="gpt-conversation-id">Conversation ID (optional):</label>
                            <input type="text" id="gpt-conversation-id" placeholder="Leave empty for new conversation">
                        </div>
                        <div class="form-group">
                            <label for="gpt-model">Model:</label>
                            <select id="gpt-model">
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                <option value="gpt-4">GPT-4</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="gpt-max-tokens">Max Tokens:</label>
                            <input type="number" id="gpt-max-tokens" placeholder="1000" value="1000" min="100" max="4000">
                        </div>
                        <button class="test-button" onclick="testGPTChat()">
                            <span class="button-text">Test API</span>
                        </button>
                        <div class="result-container" id="gpt-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="gpt-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('gpt-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Request Body:</span>
                            <div class="result-box" id="gpt-request-body"></div>
                            <button class="copy-button" onclick="copyToClipboard('gpt-request-body')">Copy Request</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="gpt-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('gpt-response')">Copy Response</button>
                        </div>
                    </div>
                </div>

                <!-- Get Conversation History -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-get">GET</span>
                        Get Conversation History
                    </div>
                    <div class="endpoint-description">
                        Retrieve the history of a conversation
                    </div>
                    
                    <div class="test-form">
                        <div class="form-group">
                            <label for="history-conversation-id">Conversation ID:</label>
                            <input type="text" id="history-conversation-id" placeholder="Enter conversation ID">
                        </div>
                        <button class="test-button" onclick="testConversationHistory()">
                            <span class="button-text">Test API</span>
                        </button>
                        <div class="result-container" id="history-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="history-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('history-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="history-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('history-response')">Copy Response</button>
                        </div>
                    </div>
                </div>

                <!-- Clear Conversation -->
                <div class="endpoint-card">
                    <div class="endpoint-title">
                        <span class="method-badge method-post">POST</span>
                        Clear Conversation
                    </div>
                    <div class="endpoint-description">
                        Clear the history of a conversation
                    </div>
                    
                    <div class="test-form">
                        <div class="form-group">
                            <label for="clear-conversation-id">Conversation ID:</label>
                            <input type="text" id="clear-conversation-id" placeholder="Enter conversation ID">
                        </div>
                        <button class="test-button" onclick="testClearConversation()">
                            <span class="button-text">Test API</span>
                        </button>
                                                <div class="result-container" id="clear-result">
                            <span class="api-url-label">üì° API Endpoint Used:</span>
                            <div class="api-url-display" id="clear-api-url"></div>
                            <button class="copy-button" onclick="copyToClipboard('clear-api-url')">Copy URL</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Request Body:</span>
                            <div class="result-box" id="clear-request-body"></div>
                            <button class="copy-button" onclick="copyToClipboard('clear-request-body')">Copy Request</button>
                            <span class="api-url-label" style="margin-top: 15px;">üìã Response:</span>
                            <div class="result-box" id="clear-response"></div>
                            <button class="copy-button" onclick="copyToClipboard('clear-response')">Copy Response</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <h3>Ntando Mods API</h3>
            <p style="margin: 15px 0;">Built with ‚ù§Ô∏è for developers</p>
            <p>
                <a href="/api/docs">API Docs (JSON)</a> | 
                <a href="/api/health">Health Check</a> | 
                <a href="https://github.com/ntandomods">GitHub</a>
            </p>
            <p style="margin-top: 20px; opacity: 0.7; font-size: 0.9em;">
                ¬© 2024 Ntando Mods. All rights reserved.
            </p>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        const API_BASE_URL = window.location.origin;

        // Check API health status
        async function checkAPIHealth() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                const data = await response.json();
                if (data.success) {
                    document.getElementById('api-status').textContent = 'Online';
                    document.querySelector('.status-indicator').style.background = '#28a745';
                } else {
                    document.getElementById('api-status').textContent = 'Offline';
                    document.querySelector('.status-indicator').style.background = '#dc3545';
                }
            } catch (error) {
                document.getElementById('api-status').textContent = 'Offline';
                document.querySelector('.status-indicator').style.background = '#dc3545';
            }
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.style.background = type === 'success' ? '#28a745' : '#dc3545';
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Copy to clipboard
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!');
            }).catch(() => {
                showToast('Failed to copy', 'error');
            });
        }

        // Show loading state
        function setLoading(buttonElement, isLoading) {
            const buttonText = buttonElement.querySelector('.button-text');
            if (isLoading) {
                buttonElement.disabled = true;
                buttonText.innerHTML = '<span class="loading"></span> Loading...';
            } else {
                buttonElement.disabled = false;
                buttonText.textContent = 'Test API';
            }
        }

        // Display result
        function displayResult(resultContainerId, apiUrlId, responseId, apiUrl, response, isSuccess = true) {
            const resultContainer = document.getElementById(resultContainerId);
            const apiUrlElement = document.getElementById(apiUrlId);
            const responseElement = document.getElementById(responseId);

            apiUrlElement.textContent = apiUrl;
            responseElement.textContent = JSON.stringify(response, null, 2);
            responseElement.className = isSuccess ? 'result-box result-success' : 'result-box result-error';
            resultContainer.classList.add('show');
        }

        // Test MP3 Download
        async function testMP3() {
            const button = event.target.closest('.test-button');
            const url = document.getElementById('mp3-url').value;

            if (!url) {
                showToast('Please enter a YouTube URL', 'error');
                return;
            }

            setLoading(button, true);

            const apiUrl = `${API_BASE_URL}/api/youtube/mp3?url=${encodeURIComponent(url)}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                displayResult('mp3-result', 'mp3-api-url', 'mp3-response', apiUrl, data, response.ok);
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                displayResult('mp3-result', 'mp3-api-url', 'mp3-response', apiUrl, { error: error.message }, false);
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Test MP4 Download
        async function testMP4() {
            const button = event.target.closest('.test-button');
            const url = document.getElementById('mp4-url').value;
            const quality = document.getElementById('mp4-quality').value;

            if (!url) {
                showToast('Please enter a YouTube URL', 'error');
                return;
            }

            setLoading(button, true);

            const apiUrl = `${API_BASE_URL}/api/youtube/mp4?url=${encodeURIComponent(url)}&quality=${quality}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                displayResult('mp4-result', 'mp4-api-url', 'mp4-response', apiUrl, data, response.ok);
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                displayResult('mp4-result', 'mp4-api-url', 'mp4-response', apiUrl, { error: error.message }, false);
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Test YouTube Search
        async function testSearch() {
            const button = event.target.closest('.test-button');
            const query = document.getElementById('search-query').value;
            const limit = document.getElementById('search-limit').value;

            if (!query) {
                showToast('Please enter a search query', 'error');
                return;
            }

            setLoading(button, true);

            const apiUrl = `${API_BASE_URL}/api/youtube/search?q=${encodeURIComponent(query)}&limit=${limit}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                displayResult('search-result', 'search-api-url', 'search-response', apiUrl, data, response.ok);
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                displayResult('search-result', 'search-api-url', 'search-response', apiUrl, { error: error.message }, false);
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Test Video Info
        async function testInfo() {
            const button = event.target.closest('.test-button');
            const url = document.getElementById('info-url').value;

            if (!url) {
                showToast('Please enter a YouTube URL', 'error');
                return;
            }

            setLoading(button, true);

            const apiUrl = `${API_BASE_URL}/api/youtube/info?url=${encodeURIComponent(url)}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                displayResult('info-result', 'info-api-url', 'info-response', apiUrl, data, response.ok);
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                displayResult('info-result', 'info-api-url', 'info-response', apiUrl, { error: error.message }, false);
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Test GPT Chat
        async function testGPTChat() {
            const button = event.target.closest('.test-button');
            const message = document.getElementById('gpt-message').value;
            const conversationId = document.getElementById('gpt-conversation-id').value;
            const model = document.getElementById('gpt-model').value;
            const maxTokens = document.getElementById('gpt-max-tokens').value;

            if (!message) {
                showToast('Please enter a message', 'error');
                return;
            }

            setLoading(button, true);

            const apiUrl = `${API_BASE_URL}/api/gpt/chat`;
            const requestBody = {
                message: message,
                ...(conversationId && { conversationId: conversationId }),
                model: model,
                maxTokens: parseInt(maxTokens)
            };

            // Display request body
            document.getElementById('gpt-request-body').textContent = JSON.stringify(requestBody, null, 2);
            document.getElementById('gpt-request-body').className = 'result-box';

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });
                const data = await response.json();
                
                const resultContainer = document.getElementById('gpt-result');
                document.getElementById('gpt-api-url').textContent = apiUrl;
                document.getElementById('gpt-response').textContent = JSON.stringify(data, null, 2);
                document.getElementById('gpt-response').className = response.ok ? 'result-box result-success' : 'result-box result-error';
                resultContainer.classList.add('show');
                
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                document.getElementById('gpt-response').textContent = JSON.stringify({ error: error.message }, null, 2);
                document.getElementById('gpt-response').className = 'result-box result-error';
                document.getElementById('gpt-result').classList.add('show');
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Test Conversation History
        async function testConversationHistory() {
            const button = event.target.closest('.test-button');
            const conversationId = document.getElementById('history-conversation-id').value;

            if (!conversationId) {
                showToast('Please enter a conversation ID', 'error');
                return;
            }

            setLoading(button, true);

                        const apiUrl = `${API_BASE_URL}/api/gpt/conversation?conversationId=${encodeURIComponent(conversationId)}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                displayResult('history-result', 'history-api-url', 'history-response', apiUrl, data, response.ok);
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                displayResult('history-result', 'history-api-url', 'history-response', apiUrl, { error: error.message }, false);
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Test Clear Conversation
        async function testClearConversation() {
            const button = event.target.closest('.test-button');
            const conversationId = document.getElementById('clear-conversation-id').value;

            if (!conversationId) {
                showToast('Please enter a conversation ID', 'error');
                return;
            }

            setLoading(button, true);

            const apiUrl = `${API_BASE_URL}/api/gpt/clear`;
            const requestBody = {
                conversationId: conversationId
            };

            // Display request body
            document.getElementById('clear-request-body').textContent = JSON.stringify(requestBody, null, 2);
            document.getElementById('clear-request-body').className = 'result-box';

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });
                const data = await response.json();
                
                const resultContainer = document.getElementById('clear-result');
                document.getElementById('clear-api-url').textContent = apiUrl;
                document.getElementById('clear-response').textContent = JSON.stringify(data, null, 2);
                document.getElementById('clear-response').className = response.ok ? 'result-box result-success' : 'result-box result-error';
                resultContainer.classList.add('show');
                
                showToast(response.ok ? 'API test successful!' : 'API test failed', response.ok ? 'success' : 'error');
            } catch (error) {
                document.getElementById('clear-response').textContent = JSON.stringify({ error: error.message }, null, 2);
                document.getElementById('clear-response').className = 'result-box result-error';
                document.getElementById('clear-result').classList.add('show');
                showToast('Request failed', 'error');
            } finally {
                setLoading(button, false);
            }
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', () => {
            checkAPIHealth();
            // Check API health every 30 seconds
            setInterval(checkAPIHealth, 30000);
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + Enter to submit focused form
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                const activeElement = document.activeElement;
                const form = activeElement.closest('.test-form');
                if (form) {
                    const button = form.querySelector('.test-button');
                    if (button && !button.disabled) {
                        button.click();
                    }
                }
            }
        });

        // Add smooth scroll behavior
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add input validation
        document.querySelectorAll('input[type="text"], textarea').forEach(input => {
            input.addEventListener('input', function() {
                if (this.value.trim()) {
                    this.style.borderColor = '#667eea';
                } else {
                    this.style.borderColor = '#ddd';
                }
            });
        });

        // Add focus effects
        document.querySelectorAll('input, textarea, select').forEach(element => {
            element.addEventListener('focus', function() {
                this.style.boxShadow = '0 0 0 3px rgba(102, 126, 234, 0.1)';
            });
            
            element.addEventListener('blur', function() {
                this.style.boxShadow = 'none';
            });
        });

        // Format JSON in result boxes
        function formatJSON(json) {
            try {
                return JSON.stringify(JSON.parse(json), null, 2);
            } catch (e) {
                return json;
            }
        }

        // Add export functionality
        function exportResults(resultId) {
            const resultElement = document.getElementById(resultId);
            if (resultElement) {
                const text = resultElement.textContent;
                const blob = new Blob([text], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `api-result-${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showToast('Results exported successfully!');
            }
        }

        // Add clear all results functionality
        function clearAllResults() {
            document.querySelectorAll('.result-container').forEach(container => {
                container.classList.remove('show');
            });
            showToast('All results cleared!');
        }

        // Add request history
        const requestHistory = [];
        const MAX_HISTORY = 10;

        function addToHistory(endpoint, method, params) {
            requestHistory.unshift({
                endpoint,
                method,
                params,
                timestamp: new Date().toISOString()
            });
            
            if (requestHistory.length > MAX_HISTORY) {
                requestHistory.pop();
            }
            
            localStorage.setItem('apiRequestHistory', JSON.stringify(requestHistory));
        }

        function loadHistory() {
            const saved = localStorage.getItem('apiRequestHistory');
            if (saved) {
                try {
                    return JSON.parse(saved);
                } catch (e) {
                    return [];
                }
            }
            return [];
        }

        // Add error logging
        function logError(error, context) {
            console.error(`[API Error - ${context}]:`, error);
            // You can send this to a logging service
        }

        // Add retry functionality
        async function retryRequest(requestFn, maxRetries = 3, delay = 1000) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    return await requestFn();
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    await new Promise(resolve => setTimeout(resolve, delay * (i + 1)));
                }
            }
        }

        // Add request timeout
        function fetchWithTimeout(url, options = {}, timeout = 30000) {
            return Promise.race([
                fetch(url, options),
                new Promise((_, reject) =>
                    setTimeout(() => reject(new Error('Request timeout')), timeout)
                )
            ]);
        }

        // Add network status indicator
        window.addEventListener('online', () => {
            showToast('Connection restored', 'success');
            checkAPIHealth();
        });

        window.addEventListener('offline', () => {
            showToast('No internet connection', 'error');
            document.getElementById('api-status').textContent = 'Offline';
            document.querySelector('.status-indicator').style.background = '#dc3545';
        });

        // Add performance monitoring
        function measurePerformance(label, fn) {
            const start = performance.now();
            const result = fn();
            const end = performance.now();
            console.log(`[Performance - ${label}]: ${(end - start).toFixed(2)}ms`);
            return result;
        }

        // Add dark mode toggle (optional enhancement)
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        // Load dark mode preference
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
        }

        // Add print functionality
        function printResults() {
            window.print();
        }

        // Add share functionality
        async function shareResults(resultId) {
            const resultElement = document.getElementById(resultId);
            if (resultElement && navigator.share) {
                try {
                    await navigator.share({
                        title: 'API Test Results',
                        text: resultElement.textContent
                    });
                    showToast('Results shared successfully!');
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        showToast('Failed to share results', 'error');
                    }
                }
            } else {
                copyToClipboard(resultId);
            }
        }

        // Add auto-save functionality for form inputs
        function saveFormState() {
            const formData = {};
            document.querySelectorAll('input, textarea, select').forEach(element => {
                if (element.id) {
                    formData[element.id] = element.value;
                }
            });
            localStorage.setItem('formState', JSON.stringify(formData));
        }

        function loadFormState() {
            const saved = localStorage.getItem('formState');
            if (saved) {
                try {
                    const formData = JSON.parse(saved);
                    Object.keys(formData).forEach(id => {
                        const element = document.getElementById(id);
                        if (element && formData[id]) {
                            element.value = formData[id];
                        }
                    });
                } catch (e) {
                    console.error('Failed to load form state:', e);
                }
            }
        }

        // Auto-save form state on input
        document.addEventListener('input', () => {
            clearTimeout(window.saveTimeout);
            window.saveTimeout = setTimeout(saveFormState, 1000);
        });

        // Load form state on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadFormState();
        });

        // Add analytics tracking (optional)
        function trackEvent(category, action, label) {
            console.log(`[Analytics] ${category} - ${action} - ${label}`);
            // You can integrate with Google Analytics or other services here
        }

        // Track API calls
        function trackAPICall(endpoint, success) {
            trackEvent('API', success ? 'Success' : 'Error', endpoint);
        }

        console.log('%cüöÄ Ntando Mods API Documentation', 'color: #667eea; font-size: 20px; font-weight: bold;');
        console.log('%cWelcome to the interactive API documentation!', 'color: #764ba2; font-size: 14px;');
        console.log('%cTip: Press Ctrl/Cmd + Enter to quickly submit forms', 'color: #28a745; font-size: 12px;');
    </script>
</body>
</html>

